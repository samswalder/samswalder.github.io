(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const R={version:1,user:{firstVisit:!0,assessmentComplete:!1,baselineWPM:0,dateJoined:null},progress:{currentStage:1,currentLevel:1,currentSubStage:"homeRow",exercisesAtCurrentLevel:0,consecutiveGoalsMet:0},goals:{currentTargetWPM:0,goalsMetTotal:0},stats:{personalBestWPM:0,personalBestAccuracy:0,totalExercises:0,totalTimeSpentMs:0},history:[],streak:{currentStreak:0,longestStreak:0,lastPlayedDate:null}};let z=null;const P=new Map;function B(e){return JSON.parse(JSON.stringify(e))}function ne(e){z=e?{...B(R),...B(e)}:B(R)}function b(){return B(z)}function se(){return z}function T(e){e(z),re()}function ae(e,t){return P.has(e)||P.set(e,new Set),P.get(e).add(t),()=>P.get(e)?.delete(t)}function re(e){for(const[t,n]of P)for(const a of n)a(b())}const J="typing-yaad-save";function oe(e){try{const t=JSON.stringify(e);localStorage.setItem(J,t)}catch(t){console.warn("Failed to save state:",t)}}function ie(){try{const e=localStorage.getItem(J);if(!e)return null;const t=JSON.parse(e);return!t||typeof t!="object"||!t.version?null:t}catch(e){return console.warn("Failed to load state:",e),null}}const ce=e=>document.querySelector(e);function r(e,t={},n=[]){const a=document.createElement(e);for(const[s,i]of Object.entries(t))s==="className"?a.className=i:s==="textContent"?a.textContent=i:s==="innerHTML"?a.innerHTML=i:s.startsWith("on")?a.addEventListener(s.slice(2).toLowerCase(),i):s==="style"&&typeof i=="object"?Object.assign(a.style,i):a.setAttribute(s,i);for(const s of n)typeof s=="string"?a.appendChild(document.createTextNode(s)):s&&a.appendChild(s);return a}let L=null;function C(e){const t=ce("#app");if(L){L.classList.add("screen-exit");const n=L;setTimeout(()=>n.remove(),300)}e.classList.add("screen"),t.appendChild(e),L=e}function le(e){document.body.appendChild(e)}function I(e){e&&(e.classList.add("hiding"),setTimeout(()=>e.remove(),300))}function ue(e){return r("div",{className:"screen-content"},[r("div",{className:"screen-header"},[r("h1",{innerHTML:"üáØüá≤ Typing Yaad",style:{fontSize:"var(--font-size-hero)",marginBottom:"var(--space-md)"}}),r("p",{textContent:"Welcome! Let's find out how fast yuh type.",style:{fontSize:"var(--font-size-xl)",marginBottom:"var(--space-sm)"}}),r("p",{textContent:"We'll start with a quick test, then help yuh get faster step by step.",style:{color:"var(--color-text-dim)",marginBottom:"var(--space-2xl)"}})]),r("button",{className:"btn-primary",textContent:"Let's Start!",onClick:e,style:{fontSize:"var(--font-size-xl)",padding:"var(--space-lg) var(--space-3xl)"}})])}class _{constructor(t){this.prompt=t,this.currentIndex=0,this.chars=t.split("").map(n=>({char:n,status:"upcoming"})),this.startTime=null,this.endTime=null,this.totalKeystrokes=0,this.correctKeystrokes=0,this.incorrectKeystrokes=0,this.finished=!1,this.listeners={},this._handleKeydown=this._onKeydown.bind(this)}start(){this.chars[0].status="current",document.addEventListener("keydown",this._handleKeydown),this.emit("start"),this.emit("update",this.getSnapshot())}stop(){document.removeEventListener("keydown",this._handleKeydown)}destroy(){this.stop(),this.listeners={}}_onKeydown(t){if(this.finished||["Shift","Control","Alt","Meta","CapsLock","Tab","Escape"].includes(t.key))return;if(t.key==="Backspace"){t.preventDefault(),this.currentIndex>0&&(this.currentIndex--,this.chars[this.currentIndex].status="current",this.currentIndex+1<this.chars.length&&(this.chars[this.currentIndex+1].status="upcoming"),this.emit("update",this.getSnapshot()));return}if(t.key.length>1)return;t.preventDefault(),this.startTime||(this.startTime=performance.now()),this.totalKeystrokes++;const n=this.chars[this.currentIndex].char;if(t.key===n?(this.chars[this.currentIndex].status="correct",this.correctKeystrokes++):(this.chars[this.currentIndex].status="incorrect",this.incorrectKeystrokes++),this.currentIndex++,this.currentIndex>=this.chars.length){this.finished=!0,this.endTime=performance.now(),this.stop(),this.emit("update",this.getSnapshot()),this.emit("complete",this.getResults());return}this.chars[this.currentIndex].status="current",this.emit("update",this.getSnapshot())}getSnapshot(){return{chars:this.chars.map(t=>({...t})),currentIndex:this.currentIndex,wpm:this.getCurrentWPM(),accuracy:this.getCurrentAccuracy(),finished:this.finished}}getCurrentWPM(){if(!this.startTime||this.correctKeystrokes===0)return 0;const n=((this.finished?this.endTime:performance.now())-this.startTime)/6e4;return n<.01?0:Math.round(this.correctKeystrokes/5/n)}getCurrentAccuracy(){return this.totalKeystrokes===0?100:Math.round(this.correctKeystrokes/this.totalKeystrokes*100)}getResults(){const t=this.endTime-this.startTime;return{wpm:this.getCurrentWPM(),accuracy:this.getCurrentAccuracy(),totalChars:this.chars.length,correctChars:this.correctKeystrokes,incorrectChars:this.incorrectKeystrokes,durationMs:Math.round(t),prompt:this.prompt}}on(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)}emit(t,n){if(this.listeners[t])for(const a of this.listeners[t])a(n)}}function H(e){const t=r("div",{className:"typing-area"});return e.appendChild(t),{element:t,update(n){t.innerHTML="";for(const{char:a,status:s}of n.chars){const i=a===" ",c=r("span",{className:`char ${s}${i?" space":""}`,textContent:i?"¬†":a});t.appendChild(c)}n.finished?t.classList.remove("active"):t.classList.add("active")},destroy(){t.remove()}}}const N={1:{name:"Home Keys",description:"Get yuh fingers comfortable",icon:"‚å®Ô∏è",subStages:["homeRow","topRow","bottomRow","allKeys"],levelsPerSubStage:3,minAccuracyToAdvance:80,consecutiveGoalsNeeded:2},2:{name:"Short Words",description:"Small words, big progress",icon:"ü•≠",levels:4,minAccuracyToAdvance:82,consecutiveGoalsNeeded:2},3:{name:"Longer Words",description:"Building up yuh speed",icon:"üå¥",levels:3,minAccuracyToAdvance:85,consecutiveGoalsNeeded:2},4:{name:"Jamaican Proverbs",description:"Wisdom from di island",icon:"üìú",levels:3,minAccuracyToAdvance:85,consecutiveGoalsNeeded:2},5:{name:"Full Sentences",description:"Yuh a pro now!",icon:"üèÜ",levels:3,minAccuracyToAdvance:88,consecutiveGoalsNeeded:2}},W={stage1:{homeRow:{level1:["asdf jkl;","fjdk slaf","asdl fkj;","jfkd ;lsa","fads jlk;","dflk ja;s","salad flask","ask dad"],level2:["fall lads flask","salad dads asks","sad lad dad fall","all fallask dad","a lass dads lads","flask salad fall"],level3:["a sad lad asks dad","all lads fall fast","dad asks all lads","flask salad lads","sad dad falls","ask a lass all"]},topRow:{level1:["qwer tyui op","were trip poet","your type quit","true ripe wire","pour trip pier","wipe tour ripe"],level2:["write your quote","poetry tower power","quiet trip writer","proper route type","tower power trip","outer quite quiet"],level3:["write your top quote","type poetry with power","quite proper writing","tower trip requires wit","your quiet writer tip","power trip outer route"]},bottomRow:{level1:["zxcv bnm","man can ban van","mix box zen cab","bam nab zen vim","van cab man ban","mix vex bam nab"],level2:["came back bank","zinc venom comic","cabin blank brand","bench meant cabin","blank zinc bench","brand comic cabin"],level3:["brave men climb banks","zinc cabin bench brand","blank comic became calm","combine brave cabin men","bank bench cabin brand","brave men became calm"]},allKeys:{level1:["the quick brown fox","jump over lazy dog","mix zip vex jab calm","quiz blank might joy","pack wedge fix rhythm","five boxing wizards"],level2:["bright stars above calm","jumping fox with vigor","twelve crazy quips amaze","quick brown fox leaps high","brave wizard calmly fixed","jinxed pygmy wax bluff"],level3:["the five boxing wizards jump quickly","pack my red box with five dozen jugs","crazy fox jumped over every lazy dog","grumpy wizards make toxic brew for jinx","the quick brown fox jumps over lazy dogs","six crazy kings vowed to abolish joy"]}},stage2:{level1:["jerk rice fish","yam run eat hot","sea sun fun day","one two red big","rum tea hut bay","jam pot tin cup","hot sun big fun","red yam sea hut"],level2:["ackee mango lime","dance beach music","green gold black","sweet spice juice","patty cocoa bread","river hills trees","fresh fruit stand","warm island winds"],level3:["curry goat pepper","reggae rhythm bass","bamboo coconut palm","market fresh catch","sunset golden beach","garden callaloo stew","banana ginger sorrel","harbor fishing boats"],level4:["festival dumpling bammy","kingfish escoveitch snapper","breadfruit plantain cassava","pimento allspice nutmeg","jackfruit soursop guinep","jerk chicken oxtail curry","ackee saltfish breakfast","sorrel ginger holiday drink"]},stage3:{level1:["Kingston harbour sunrise","Montego Bay sunset","Ocho Rios waterfall","Blue Mountain coffee","Port Royal history","Negril seven miles","Mandeville cool breeze","Portland rain forest"],level2:["ackee and saltfish morning","jerk chicken pimento wood","fresh coconut water beach","sorrel drink at Christmas","curry goat Sunday dinner","festival beside the fish","callaloo with salt pork","bammy cassava golden fried"],level3:["the Blue Mountains are beautiful","reggae music fills the streets","hummingbird is the national bird","dancehall started in Kingston","coffee grows in the mountains","the beach sand feels warm and soft","mango season is the sweetest time","cricket is played across the island"]},stage4:{level1:["Every day bucket go a well.","One one coco full basket.","Wha sweet nanny goat a go run him belly.","Patient man ride donkey.","Sorry fi maga dog, maga dog turn round bite yuh.","New broom sweep clean but old broom know di corners.","Cock mouth kill cock.","Play wid puppy, puppy lick yuh face."],level2:["Di higher monkey climb di more him expose.","If yuh cyaan hear, yuh mus feel.","When trouble tek yuh, pickney shut fit yuh.","Trouble never set like rain.","Nuh dash weh yuh stick before yuh done cross river.","When yuh hand in lion mouth, tek time draw it out.","See me and come live wid me is two different things.","Duppy know who fi frighten."],level3:["When yuh go a jackass yard, yuh nuh fi chat bout long ears.","Mi throw mi corn, mi nuh call nuh fowl.","Before good food waste, mek belly bust.","One hand cyaan clap.","De olda de moon, de brighter it shines.","When man belly full, him break pot.","Monkey should know where him going to put him tail before him order trousers.","Empty barrel mek di most noise."]},stage5:{level1:["Ackee and saltfish is the national dish of Jamaica.","The Blue Mountains are famous for their coffee beans.","Bob Marley brought reggae music to the whole world.","Jamaica gained independence from Britain in 1962.","The national bird is the red-billed streamertail.","Usain Bolt is the fastest man in recorded history.","Dunn's River Falls is a famous landmark in Ocho Rios.","The Jamaican flag is black, green, and gold."],level2:["Jamaican patties are golden pastries filled with spiced meat or vegetables.","The annual carnival celebrations fill the streets of Kingston with color.","Blue Mountain coffee is considered among the finest in the world.","Cricket and track and field are the most popular sports on the island.","The warm Caribbean waters surround Jamaica with beautiful coral reefs.","Jamaican music has influenced artists and genres all around the globe.","The lush green mountains contrast with the turquoise blue ocean waters.","Market vendors sell fresh fruit and vegetables every day of the week."],level3:['The national motto of Jamaica is "Out of Many, One People" reflecting the diverse heritage.',"Jerk seasoning combines scotch bonnet peppers, allspice, thyme, and other aromatic spices.","Nine Mile in Saint Ann Parish is the birthplace and final resting place of Bob Marley.","The annual Jamaica Jazz and Blues Festival attracts musicians from all around the world.","Jamaican Blue Mountain coffee is grown at elevations between three and five thousand feet.","Kingston is the capital and largest city, known for its vibrant culture and rich history.","The lignum vitae is the national tree, known for its extremely hard and dense wood.","Doctor birds, with their long tail streamers, are found nowhere else in the world."]},assessment:["Jamaica is a beautiful island.","The sun shines bright today.","Typing gets better with practice."]};function de(e,t,n){return e===1&&n?W.stage1[n]?.[`level${t}`]||[]:W[`stage${e}`]?.[`level${t}`]||[]}function q(e,t){const n=N[e];return n?e===1&&t?n.levelsPerSubStage:n.levels||0:0}function he(e){const t=N[1].subStages,n=t.indexOf(e);return n<t.length-1?t[n+1]:null}function me(e){if(e.length===0)return 0;const t=[...e].sort((a,s)=>a-s),n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2}function k(e){return e[Math.floor(Math.random()*e.length)]}function ge(){return[...W.assessment]}function pe(e){const t=e.map(n=>n.wpm);return Math.round(me(t))}function fe(e){const t=ge(),n=[];let a=null,s=null;const i=r("p",{style:{textAlign:"center",color:"var(--color-text-dim)",marginBottom:"var(--space-sm)"},textContent:`Sentence 1 of ${t.length}`}),c=r("p",{style:{textAlign:"center",marginBottom:"var(--space-xl)",color:"var(--color-text-dim)",fontSize:"var(--font-size-sm)"},textContent:"Type the text below as quickly and accurately as you can."}),o=r("div",{style:{width:"100%"}}),u=r("div",{style:{textAlign:"center",marginTop:"var(--space-lg)",minHeight:"2rem"}}),g=r("div",{className:"screen-content"},[r("div",{className:"screen-header"},[r("h1",{textContent:"Let's See Where Yuh At"}),r("p",{textContent:"Type these 3 short sentences so we can measure your speed."})]),i,c,o,u]);function d(p){i.textContent=`Sentence ${p+1} of ${t.length}`,u.innerHTML="",s&&s.destroy(),a=new _(t[p]),s=H(o),a.on("update",m=>s.update(m)),a.on("complete",m=>{if(n.push(m),u.innerHTML="",u.appendChild(r("p",{textContent:`Nice! ${m.wpm} WPM`,style:{color:"var(--color-green-light)",fontWeight:"700",fontSize:"var(--font-size-lg)"}})),p<t.length-1)setTimeout(()=>d(p+1),1200);else{const f=pe(n);setTimeout(()=>e(f,n),1500)}}),a.start()}return d(0),{element:g,destroy(){a?.destroy(),s?.destroy()}}}function ye(e,t){const n=r("div",{className:"live-stats"},[r("div",{className:"live-stat"},[r("div",{className:"live-stat-value",id:"live-wpm",textContent:"0"}),r("div",{className:"live-stat-label",textContent:"WPM"})]),r("div",{className:"live-stat"},[r("div",{className:"live-stat-value",id:"live-accuracy",textContent:"100%"}),r("div",{className:"live-stat-label",textContent:"Accuracy"})])]);e.appendChild(n);let a=null,s=null;function i(o){s=o,a=setInterval(()=>{if(!s)return;const u=s.getCurrentWPM(),g=s.getCurrentAccuracy(),d=n.querySelector("#live-wpm"),p=n.querySelector("#live-accuracy");d&&(d.textContent=u,d.className=`live-stat-value${u>=t?" good":""}`),p&&(p.textContent=`${g}%`)},500)}function c(){a&&clearInterval(a),a=null,s=null}return{element:n,startUpdating:i,stopUpdating:c,destroy(){c(),n.remove()}}}function ve({prompt:e,stage:t,level:n,goalWPM:a,stageName:s,onComplete:i}){let c=null,o=null,u=null;const g=r("div",{className:"exercise-header"},[r("span",{className:"stage-label",textContent:`${s} ‚Ä¢ Level ${n}`}),r("span",{className:"goal-label",textContent:`Goal: ${a} WPM`})]),d=r("div",{style:{width:"100%"}}),p=r("div",{style:{width:"100%"}}),m=r("p",{className:"typing-area-hint",textContent:"Start typing to begin..."}),f=r("div",{},[g,d,m,p]);return c=new _(e),o=H(d),u=ye(p,a),c.on("start",()=>{m.style.display="none"}),c.on("update",l=>{o.update(l),l.currentIndex>0&&!u._started&&(u.startUpdating(c),u._started=!0)}),c.on("complete",l=>{u.stopUpdating(),setTimeout(()=>i(l),500)}),c.start(),{element:f,destroy(){c?.destroy(),o?.destroy(),u?.destroy()}}}function U({wpm:e,accuracy:t,goalWPM:n,goalMet:a,isPersonalBest:s,celebrationMessage:i,onNext:c,onDashboard:o,nextLabel:u}){const g=a?"met":"missed",d=a?`‚úÖ Goal of ${n} WPM achieved!`:`Goal: ${n} WPM ‚Äî just ${n-e} WPM away!`,p=r("div",{style:{textAlign:"center"}},[r("div",{className:"wpm-result",textContent:"0"}),r("div",{className:"wpm-result-label",textContent:"words per minute"})]),m=p.querySelector(".wpm-result"),f=r("div",{className:`result-goal ${g}`,textContent:d}),l=r("div",{className:"result-accuracy",textContent:`Accuracy: ${t}%`}),y=s?r("div",{className:"badge badge-gold",textContent:"‚≠ê New Personal Best!",style:{marginTop:"var(--space-md)",display:"inline-block"}}):null,S=i?r("p",{textContent:i,style:{color:"var(--color-gold)",fontSize:"var(--font-size-xl)",fontWeight:"700",marginTop:"var(--space-xl)",textAlign:"center"}}):null,x=r("div",{className:"result-actions"},[r("button",{className:"btn-primary",textContent:u||(a?"Next Exercise":"One More Go!"),onClick:c}),...o?[r("button",{className:"btn-secondary",textContent:"View Progress",onClick:o})]:[]]),A=r("div",{className:"screen-content"},[p,f,l,...y?[y]:[],...S?[S]:[],x]),h=e,v=600,w=performance.now();function $(){const Z=performance.now()-w,K=Math.min(Z/v,1),ee=1-Math.pow(1-K,3),te=Math.round(ee*h);m.textContent=te,K<1&&requestAnimationFrame($)}return requestAnimationFrame($),A}function be(e,t){const n=N[e.currentStage];return!(!n||!t.goalMet||t.accuracy<n.minAccuracyToAdvance||e.consecutiveGoalsMet<n.consecutiveGoalsNeeded)}function we(e){const t=e.currentStage,n=e.currentLevel,a=e.currentSubStage;if(t===1){const i=q(t,a);if(n<i)return{stage:1,level:n+1,subStage:a};const c=he(a);return c?{stage:1,level:1,subStage:c}:{stage:2,level:1,subStage:null}}const s=q(t,null);return n<s?{stage:t,level:n+1,subStage:null}:t<5?{stage:t+1,level:1,subStage:null}:{stage:5,level:s,subStage:null}}function Se(e,t,n,a){const s=de(e,t,n);if(s.length===0)return"the quick brown fox jumps over the lazy dog";const i=a.slice(-5).map(u=>u.prompt),c=s.filter(u=>!i.includes(u)),o=c.length>0?c:s;return k(o)}function xe(e){return e<10?{stage:1,level:1,subStage:"homeRow"}:e<15?{stage:1,level:1,subStage:"allKeys"}:e<20?{stage:2,level:1,subStage:null}:e<30?{stage:3,level:1,subStage:null}:{stage:4,level:1,subStage:null}}function O(e,t){const n=N[e];if(!n)return"";if(e===1&&t){const a={homeRow:"Home Row",topRow:"Top Row",bottomRow:"Bottom Row",allKeys:"All Keys"};return`${n.name}: ${a[t]||t}`}return n.name}function ke(e,t){return e.stage!==t.stage}function Ce({stage:e,subStage:t,onContinue:n}){const a=N[e],s=O(e,t);return r("div",{className:"screen-content"},[r("div",{style:{fontSize:"4rem",textAlign:"center",marginBottom:"var(--space-lg)"},textContent:a.icon}),r("h1",{textContent:s,style:{textAlign:"center",fontSize:"var(--font-size-3xl)",marginBottom:"var(--space-sm)"}}),r("p",{textContent:a.description,style:{textAlign:"center",color:"var(--color-text-dim)",fontSize:"var(--font-size-lg)",marginBottom:"var(--space-2xl)"}}),r("button",{className:"btn-primary",textContent:"Let's Go!",onClick:n,style:{fontSize:"var(--font-size-xl)",padding:"var(--space-lg) var(--space-3xl)"}})])}const G=["Big up yuhself!","Yuh a gwaan good!","Walk good, mi friend!","Yuh mash it up!","Irie vibes!","Yuh fingers dem fly!","Nice one! Yuh a star!","Bless up! Keep going!","Yes mi dear! Well done!","Yuh nailing it!"],Me=["Lawd have mercy! Yuh on fire!","Yuh a di real champion!","Boonoonoonoos! Amazing!","Yuh mek wi proud!","Wicked! Yuh a speed demon!","Yuh fingers dancing like carnival!"],Te=["New personal best! Yuh leveling up fi real!","Record breaker! Nuh stop now!","Yuh best yet! Di sky is di limit!"],Ne=["Stage complete! Moving up inna di world!","Onwards and upwards! Next level awaits!","Yuh graduate! Time fi di next challenge!"],Ae=["Almost there! Yuh getting faster!","Keep it up! Practice makes perfect!","Nuh worry! Yuh improving every time!","So close! One more try!","Yuh can do this! Try again!","Every keystroke mek yuh betta!"],Y={3:"Three days straight! Yuh consistent!",7:"One whole week! Dedication!",14:"Two weeks strong! Nuh stopping yuh now!",30:"A whole month! Yuh a typing legend!"};function F(e){switch(e){case"goalMet":return k(G);case"goalSmashed":return k(Me);case"personalBest":return k(Te);case"stageComplete":return k(Ne);case"encouragement":return k(Ae);default:return k(G)}}function Pe(e){const t=Object.keys(Y).map(Number).sort((n,a)=>a-n);for(const n of t)if(e>=n)return Y[n];return null}function De(e,t,n){const a=r("div",{className:"chart-container"});if(e.appendChild(a),t.length<2)return a.appendChild(r("div",{className:"chart-empty",textContent:"Complete a few more exercises to see your progress chart!"})),a;const s=r("canvas");return a.appendChild(s),requestAnimationFrame(()=>{const i=a.getBoundingClientRect(),c=window.devicePixelRatio||1;s.width=i.width*c,s.height=i.height*c,s.style.width=`${i.width}px`,s.style.height=`${i.height}px`;const o=s.getContext("2d");o.scale(c,c);const u=i.width,g=i.height,d={top:20,right:20,bottom:30,left:40},p=u-d.left-d.right,m=g-d.top-d.bottom,f=t.slice(-20).map(h=>h.wpm),l=Math.max(0,Math.min(...f,n||0)-5),y=Math.max(...f,n||0)+5;function S(h){return d.left+h/Math.max(f.length-1,1)*p}function x(h){return d.top+m-(h-l)/(y-l)*m}o.strokeStyle="rgba(255,255,255,0.05)",o.lineWidth=1;const A=5;for(let h=0;h<=A;h++){const v=d.top+h/A*m;o.beginPath(),o.moveTo(d.left,v),o.lineTo(u-d.right,v),o.stroke();const w=Math.round(y-h/A*(y-l));o.fillStyle="rgba(255,255,255,0.3)",o.font="11px Nunito, sans-serif",o.textAlign="right",o.fillText(w,d.left-8,v+4)}if(n&&n>=l&&n<=y){const h=x(n);o.strokeStyle="rgba(254, 209, 0, 0.4)",o.setLineDash([6,4]),o.lineWidth=1,o.beginPath(),o.moveTo(d.left,h),o.lineTo(u-d.right,h),o.stroke(),o.setLineDash([]),o.fillStyle="rgba(254, 209, 0, 0.6)",o.font="10px Nunito, sans-serif",o.textAlign="left",o.fillText(`Goal: ${n}`,u-d.right+4,h+3)}o.strokeStyle="#009B3A",o.lineWidth=2.5,o.lineJoin="round",o.lineCap="round",o.beginPath();for(let h=0;h<f.length;h++){const v=S(h),w=x(f[h]);h===0?o.moveTo(v,w):o.lineTo(v,w)}o.stroke();for(let h=0;h<f.length;h++){const v=S(h),w=x(f[h]);o.beginPath(),o.arc(v,w,4,0,Math.PI*2),o.fillStyle="#FED100",o.fill(),o.strokeStyle="#1A1A2E",o.lineWidth=2,o.stroke()}}),a}function Le({state:e,onContinue:t}){const{stats:n,progress:a,goals:s,history:i,streak:c}=e,o=Pe(c.currentStreak),u=c.currentStreak>0?`Welcome back! ${c.currentStreak} day streak!`:"Welcome back!",g=r("div",{className:"dashboard-stats"},[E(n.personalBestWPM,"Best WPM"),E(n.totalExercises,"Exercises"),E(`${c.currentStreak}`,"Day Streak")]),d=r("div",{className:"dashboard-chart-section"},[r("h2",{textContent:"Your Progress"})]);De(d,i,s.currentTargetWPM);const p=r("div",{className:"stage-map"},[r("h2",{textContent:"Stages"}),r("div",{className:"stage-list"},Be(a))]),m=r("div",{style:{textAlign:"center",margin:"var(--space-lg) 0",color:"var(--color-text-dim)"},textContent:`Current: ${O(a.currentStage,a.currentSubStage)} ‚Ä¢ Level ${a.currentLevel} ‚Ä¢ Goal: ${s.currentTargetWPM} WPM`});return r("div",{className:"dashboard"},[r("div",{className:"dashboard-greeting"},[r("h1",{textContent:u}),...o?[r("p",{textContent:o,style:{color:"var(--color-gold)"}})]:[],r("p",{textContent:"Ready fi practice?"})]),g,d,p,m,r("div",{className:"dashboard-actions"},[r("button",{className:"btn-primary",textContent:"Continue Practicing",onClick:t,style:{fontSize:"var(--font-size-xl)",padding:"var(--space-lg) var(--space-3xl)"}})])])}function E(e,t){return r("div",{className:"stat-card"},[r("div",{className:"stat-value",textContent:String(e)}),r("div",{className:"stat-label",textContent:t})])}function Be(e){const t=[];for(let n=1;n<=5;n++){const a=N[n];let s="locked";n<e.currentStage?s="completed":n===e.currentStage&&(s="current"),t.push(r("div",{className:`stage-item ${s}`},[r("span",{className:"stage-icon",textContent:a.icon}),r("div",{className:"stage-info"},[r("div",{className:"stage-name",textContent:a.name}),r("div",{className:"stage-desc",textContent:a.description})]),...s==="completed"?[r("span",{textContent:"‚úÖ"})]:[],...s==="current"?[r("span",{textContent:"üëâ",style:{color:"var(--color-gold)"}})]:[]]))}return t}function ze(e){return e<10?Math.ceil(e)+1:e<20?Math.ceil(e)+2:Math.ceil(e)+3}function Ee(e,t,n,a){if(!n)return je(a)>=5?Math.max(e-1,5):e;const s=t-e;return s<3?e+2:s<7?e+3:e+4}function We(e,t){const a={2:-2,3:-3,4:-4,5:-3}[t]||0;return Math.max(e+a,5)}function Oe(e,t,n,a){const s=e>=n,i=e>a,c=e-n;let o;return i?o="personalBest":s&&c>=5?o="goalSmashed":s?o="goalMet":o="encouragement",{goalMet:s,isPersonalBest:i,celebrationType:o,surplus:c}}function je(e){let t=0;for(let n=e.length-1;n>=0&&!e[n].goalMet;n--)t++;return t}function $e(e,t=2){const n=t===2?10:t===3?25:40,a=t===2?2e3:t===3?3e3:4e3,s=t>=4,i=[];for(let u=0;u<n;u++){const g=["gold","green","white"],d=["circle","square"],p=g[Math.floor(Math.random()*g.length)],m=d[Math.floor(Math.random()*d.length)],f=Math.random()*100,l=1.5+Math.random()*2,y=Math.random()*.5,S=360+Math.random()*720,x=r("div",{className:`confetti-particle ${m} ${p}`,style:{left:`${f}%`,"--fall-duration":`${l}s`,"--fall-delay":`${y}s`,"--spin":`${S}deg`}});i.push(x)}const c=r("div",{className:`celebration-message${s?" big":""}`,textContent:e}),o=r("div",{className:"celebration-overlay"},[c,...i]);o.addEventListener("click",()=>I(o)),le(o),setTimeout(()=>I(o),a)}let D=null;function Ke(){const e=ie();ne(e),ae("*",()=>{oe(se())}),Ge();const t=b();t.user.firstVisit?Re():t.user.assessmentComplete?X():V()}function M(){D&&(D(),D=null)}function Re(){M();const e=ue(()=>{T(t=>{t.user.firstVisit=!1,t.user.dateJoined=new Date().toISOString().split("T")[0]}),V()});C(e)}function V(){M();const e=fe((t,n)=>{const a=ze(t),s=xe(t);T(i=>{i.user.assessmentComplete=!0,i.user.baselineWPM=t,i.progress.currentStage=s.stage,i.progress.currentLevel=s.level,i.progress.currentSubStage=s.subStage,i.goals.currentTargetWPM=a,i.stats.personalBestWPM=t}),Ie(t,a)});C(e.element),D=()=>e.destroy()}function Ie(e,t){M();const n=U({wpm:e,accuracy:100,goalWPM:t,goalMet:!0,isPersonalBest:!1,celebrationMessage:`Yuh starting at ${e} WPM. Let's get yuh faster!`,onNext:()=>{const a=b();Q(a.progress.currentStage,a.progress.currentSubStage)},onDashboard:null,nextLabel:"Start Practicing!"});C(n)}function Q(e,t){M();const n=Ce({stage:e,subStage:t,onContinue:()=>j()});C(n)}function j(){M();const e=b(),{currentStage:t,currentLevel:n,currentSubStage:a}=e.progress,s=e.goals.currentTargetWPM,i=O(t,a),c=Se(t,n,a,e.history),o=ve({prompt:c,stage:t,level:n,goalWPM:s,stageName:i,onComplete:u=>qe(u)});C(o.element),D=()=>o.destroy()}function qe(e){M();const t=b(),n=t.goals.currentTargetWPM,a=t.stats.personalBestWPM,s=Oe(e.wpm,e.accuracy,n,a),i=F(s.celebrationType),c={date:new Date().toISOString(),wpm:e.wpm,accuracy:e.accuracy,stage:t.progress.currentStage,level:t.progress.currentLevel,goalWPM:n,goalMet:s.goalMet,prompt:e.prompt,durationMs:e.durationMs};T(l=>{l.history.push(c),l.history.length>200&&(l.history=l.history.slice(-200)),l.stats.totalExercises++,l.stats.totalTimeSpentMs+=e.durationMs,e.wpm>l.stats.personalBestWPM&&(l.stats.personalBestWPM=e.wpm),e.accuracy>l.stats.personalBestAccuracy&&(l.stats.personalBestAccuracy=e.accuracy);const y=new Date().toISOString().split("T")[0];l.streak.lastPlayedDate!==y&&(l.streak.lastPlayedDate=y,l.streak.currentStreak++,l.streak.currentStreak>l.streak.longestStreak&&(l.streak.longestStreak=l.streak.currentStreak)),s.goalMet?(l.goals.goalsMetTotal++,l.progress.consecutiveGoalsMet++):l.progress.consecutiveGoalsMet=0,l.progress.exercisesAtCurrentLevel++});const o=b();let u=!1,g=null;be(o.progress,c)&&(g=we(o.progress),u=ke(o.progress,g),T(l=>{l.progress.currentStage=g.stage,l.progress.currentLevel=g.level,l.progress.currentSubStage=g.subStage,l.progress.exercisesAtCurrentLevel=0,l.progress.consecutiveGoalsMet=0,u&&(l.goals.currentTargetWPM=We(l.goals.currentTargetWPM,g.stage))}));const d=b(),p=Ee(d.goals.currentTargetWPM,e.wpm,s.goalMet,d.history);T(l=>{l.goals.currentTargetWPM=p});let m=0;if(s.celebrationType==="goalMet"?m=2:s.celebrationType==="goalSmashed"?m=3:s.celebrationType==="personalBest"&&(m=4),u&&(m=4),m>=2){const l=u?F("stageComplete"):i;$e(l,m)}const f=U({wpm:e.wpm,accuracy:e.accuracy,goalWPM:n,goalMet:s.goalMet,isPersonalBest:s.isPersonalBest,celebrationMessage:m<2?i:null,onNext:()=>{u&&g?Q(g.stage,g.subStage):j()},onDashboard:()=>X()});C(f)}function X(){M();const e=b(),t=Le({state:e,onContinue:()=>j()});C(t)}function Ge(){const e=b();if(!e.streak.lastPlayedDate)return;const t=new Date().toISOString().split("T")[0],n=e.streak.lastPlayedDate;if(n===t)return;const a=new Date(n),s=new Date(t);Math.floor((s-a)/(1e3*60*60*24))>1&&T(c=>{c.streak.currentStreak=0})}Ke();
